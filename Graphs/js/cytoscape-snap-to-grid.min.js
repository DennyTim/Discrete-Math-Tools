(function(b){var a=function(c){if(!c){return}c("core","snapToGrid",function(h){var i=this;var e=h;var d=i.container();var f={stackOrder:-1,gridSpacing:40,strokeStyle:"#CCCCCC",lineWidth:1,lineDash:[5,8],zoomDash:true,panGrid:true,snapToGrid:true,drawGrid:true};var g={snapOn:function(){var j=b(this);j.trigger("snaptogrid.snapon")},snapOff:function(){var j=b(this);j.trigger("snaptogrid.snapoff")},gridOn:function(){var j=b(this);j.trigger("snaptogrid.gridon")},gridOff:function(){var j=b(this);j.trigger("snaptogrid.gridoff")},refresh:function(){var j=b(this);j.trigger("snaptogrid.refresh")},option:function(k,n){var o=b(this);var m=o.data("snapToGrid");if(m==null){return}var j=m.options;if(n===undefined){if(typeof k==typeof{}){var l=k;j=b.extend(true,{},defaults,l);m.options=j}else{return j[k]}}else{j[k]=n}o.data("snapToGrid",m);o.trigger("snaptogrid.refresh");return o},init:function(){var s=b("<canvas></canvas>");var v=b(this);var w;var j=b.extend(true,{},f,h);v.data("snapToGrid",j);var y;var z=function(){return y||(y=v.data("snapToGrid"))};var k=function(){s.attr("height",v.height()).attr("width",v.width()).css({position:"absolute",top:0,left:0,"z-index":z().stackOrder});setTimeout(function(){var B=s.offset();var A=v.offset();s.attr("height",v.height()).attr("width",v.width()).css({top:-(B.top-A.top),left:-(B.left-A.left)});p()},0)};var p=function(){r();if(!z().drawGrid){return}var I=i.zoom();var A=v.width();var D=v.height();var H=z().gridSpacing*I;var G=i.pan();var F=G.x%H;var E=G.y%H;w.strokeStyle=z().strokeStyle;w.lineWidth=z().lineWidth;if(z().zoomDash){var B=z().lineDash.slice();for(var C=0;C<B.length;C++){B[C]=z().lineDash[C]*I}w.setLineDash(B)}else{w.setLineDash(z().lineDash)}if(z().panGrid){w.lineDashOffset=-G.y}else{w.lineDashOffset=0}for(var C=F;C<A;C+=H){w.beginPath();w.moveTo(C,0);w.lineTo(C,D);w.stroke()}if(z().panGrid){w.lineDashOffset=-G.x}else{w.lineDashOffset=0}for(var C=E;C<D;C+=H){w.beginPath();w.moveTo(0,C);w.lineTo(A,C);w.stroke()}};var r=function(){var B=v.width();var A=v.height();w.clearRect(0,0,B,A)};var q=function(A){var D=A.position();var C=Math.floor(D.x/z().gridSpacing);var B=Math.floor(D.y/z().gridSpacing);A.position({x:(C+0.5)*z().gridSpacing,y:(B+0.5)*z().gridSpacing})};var n=function(){i.nodes().each(function(A){q(A)})};var o=function(A){if(z().snapToGrid){q(A.target)}};var m=function(A){if(z().snapToGrid){q(A.target)}};var l=function(){z().snapToGrid=true;n()};var u=function(){z().snapToGrid=false};var t=function(){z().drawGrid=true;p()};var x=function(){z().drawGrid=false;p()};v.append(s);b(window).on("resize",k);v.on("snaptogrid.snapon",l);v.on("snaptogrid.snapoff",u);v.on("snaptogrid.gridon",t);v.on("snaptogrid.gridoff",x);v.on("snaptogrid.refresh",k);w=s[0].getContext("2d");i.ready(function(){k();if(z().snapToGrid){n()}i.on("zoom",p);i.on("pan",p);i.on("free",o);i.on("add",m)})}};if(g[e]){return g[e].apply(d,Array.prototype.slice.call(arguments,1))}else{if(typeof e=="object"||!e){return g.init.apply(d,arguments)}else{console.error("No such function `"+e+"` for snapToGrid")}}return this})};if(typeof module!=="undefined"&&module.exports){module.exports=a}if(typeof define!=="undefined"&&define.amd){define("cytoscape-snap-to-grid",function(){return a})}if(typeof cytoscape!=="undefined"){a(cytoscape)}})(typeof jQuery!=="undefined"?jQuery:null);