(function(){var b=typeof jQuery===typeof undefined?null:jQuery;var a=function(c,d){if(!c){return}var e={menuItems:[],menuItemClasses:[],contextMenuClasses:[]};var f;c("core","contextMenus",function(z){var w=this;if(!w.scratch("cycontextmenus")){w.scratch("cycontextmenus",{})}var y=B("options");var i=B("cxtMenu");var x="cy-context-menus-cxt-menuitem";var C="cy-context-menus-divider";function r(U,R){var T={};for(var S in U){T[S]=U[S]}for(var S in R){T[S]=R[S]}return T}function B(R){return w.scratch("cycontextmenus")[R]}function s(S,R){w.scratch("cycontextmenus")[S]=R}function A(){d(".cy-context-menus-cxt-menu").contextmenu(function(){return false})}function m(S,R){var T=h(S);T+=" "+x;if(R){T+=" "+C}return T}function h(S){var U="";for(var R=0;R<S.length;R++){var T=S[R];U+=T;if(R!==S.length-1){U+=" "}}return U}function F(R){R.css("display","block")}function u(R){R.css("display","none")}function J(){i.children().css("display","none")}function D(R,T){var S;R.on("click",S=function(){T(B("currentCyEvent"))});R.data("call-on-click-function",S)}function K(S,R,V){function T(X){s("currentCyEvent",X);G(X);if(S.data("show")){if(!i.is(":visible")){F(i)}s("anyVisibleChild",true);F(S)}if(!B("anyVisibleChild")&&i.is(":visible")){u(i)}}var W;var U;if(V){w.on("cxttap",U=function(X){var Y=X.target||X.cyTarget;if(Y!=w){return}T(X)})}if(R){w.on("cxttap",R,W=function(X){T(X)})}S.data("cy-context-menus-cxtfcn",W);S.data("cy-context-menus-cxtcorefcn",U)}function E(){w.on("tapstart",f=function(){u(i);s("cxtMenuPosition",undefined);s("currentCyEvent",undefined)})}function Q(S,U,R,T){D(S,U);K(S,R,T)}function G(T){var R=B("cxtMenuPosition");var S=T.position||T.cyPosition;if(R!=S){J();s("anyVisibleChild",false);s("cxtMenuPosition",S);var X=d(w.container()).offset();var W=T.renderedPosition||T.cyRenderedPosition;var V=X.left+W.x;var U=X.top+W.y;i.css("left",V);i.css("top",U)}}function j(S){for(var R=0;R<S.length;R++){o(S[R])}}function o(R){var S=n(R);N(S);Q(S,R.onClickFunction,R.selector,R.coreAsWell)}function q(R,S){var T=n(R);t(T,S);Q(T,R.onClickFunction,R.selector,R.coreAsWell)}function P(){var R=h(y.contextMenuClasses);i=d("<div class="+R+"></div>");i.addClass("cy-context-menus-cxt-menu");s("cxtMenu",i);d("body").append(i);return i}function n(T){var S=m(y.menuItemClasses,T.hasTrailingDivider);var R='<button id="'+T.id+'" class="'+S+'"';if(T.tooltipText){R+=' title="'+T.tooltipText+'"'}if(T.disabled){R+=" disabled"}if(!T.image){R+=">"+T.content+"</button>"}else{R+='><img src="'+T.image.src+'" width="'+T.image.width+'px"; height="'+T.image.height+'px"; style="position:absolute; top: '+T.image.y+"px; left: "+T.image.x+'px;">'+T.content+"</button>"}var U=d(R);U.data("selector",T.selector);U.data("on-click-function",T.onClickFunction);U.data("show",(typeof(T.show)==="undefined"||T.show));return U}function N(R){i.append(R);g(R)}function t(R,T){var S=d("#"+T);R.insertBefore(S)}function O(){if(!B("active")){return}I();w.off("tapstart",f);i.remove();i=undefined;s(i,undefined);s("active",false);s("anyVisibleChild",false)}function I(){var R=i.children();d(R).each(function(){l(d(this))})}function l(V){var S=typeof V==="string"?d("#"+V):V;var W=S.data("cy-context-menus-cxtfcn");var R=S.data("selector");var U=S.data("call-on-click-function");var T=S.data("cy-context-menus-cxtcorefcn");if(W){w.off("cxttap",R,W)}if(T){w.off("cxttap",T)}if(U){S.off("click",U)}S.remove()}function L(S,T){if(S===T){return}var R=d("#"+S).detach();var U=d("#"+T);R.insertBefore(U)}function g(R){R.click(function(){u(i);s("cxtMenuPosition",undefined)})}function v(R){d("#"+R).attr("disabled",true)}function p(R){d("#"+R).attr("disabled",false)}function M(T,S){var R=d("#"+T);if(S){R.addClass(C)}else{R.removeClass(C)}}function H(S){var R={isActive:function(){return B("active")},appendMenuItem:function(T){o(T);return S},appendMenuItems:function(T){j(T);return S},removeMenuItem:function(T){l(T);return S},setTrailingDivider:function(U,T){M(U,T);return S},insertBeforeMenuItem:function(U,T){q(U,T);return S},moveBeforeOtherMenuItem:function(U,T){L(U,T);return S},disableMenuItem:function(T){v(T);return S},enableMenuItem:function(T){p(T);return S},hideMenuItem:function(T){d("#"+T).data("show",false);u(d("#"+T));return S},showMenuItem:function(T){d("#"+T).data("show",true);F(d("#"+T));return S},destroy:function(){O();return S}};return R}if(z!=="get"){y=r(e,z);s("options",y);if(B("active")){O()}s("active",true);i=P();var k=y.menuItems;j(k);E();A()}return H(this)})};if(typeof module!=="undefined"&&module.exports){module.exports=a}if(typeof define!=="undefined"&&define.amd){define("cytoscape-context-menus",function(){return a})}if(typeof cytoscape!=="undefined"&&b){a(cytoscape,b)}})();