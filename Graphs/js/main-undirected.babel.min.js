"use strict";var _createClass=function(){function a(e,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||false;d.configurable=true;if("value" in d){d.writable=true}Object.defineProperty(e,d.key,d)}}return function(d,b,c){if(b){a(d.prototype,b)}if(c){a(d,c)}return d}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function hideResult(d){var b=$("#cy");var a=$("#ca_tab");if(d.checked){a.hide(300,function(){b.animate({width:"1170px"},500,function(){cyReLayout()})})}else{b.animate({width:"580px"},300,function(){a.show(500,function(){reLayout()})})}}function hideWeight(c){var b=$("#weighted");if(c.checked){b.show(500);$("#wlabel").show(500)}else{b.hide(500);$("#wlabel").hide(500)}}function hideDuration(a){var b=$("#label-duration");if(a.checked){b.show(400)}else{b.hide(400)}}function callToAlgorithms(){var algo=document.getElementById("algorithms");eval(algo.options[algo.selectedIndex].value)}var cy=void 0;var ca=void 0;var defaultNodeStyle={"background-color":"#666",label:"data(id)",height:"25px",width:"25px","font-size":"20px"};var defaultEdgeStyle={width:2,"line-color":"#ccc","curve-style":"bezier",label:function label(a){return isNaN(a.data("weight"))?"":a.data("weight")},color:"red","font-size":"20px"};var layoutname="spread";var CyLayout=void 0;var CaLayout=void 0;var animationFlag=true;var copiedEles=void 0;var drawOn=false;var weight_input=document.getElementById("weight");var matrix_input=document.getElementById("matrix_input");var auto_refresh=document.getElementById("autorefresh");var perform_button=document.getElementById("perform");var animation=document.getElementById("animation");var duration=document.getElementById("duration");$(function(){cy=initializeCytoscapeObjects("cy");ca=initializeCytoscapeObjects("ca");clearCyStyle();clearCaStyle();initCircularMenu(cy);cy.graphml({layoutBy:"circle"});ca.graphml({layoutBy:"circle"});cy.edgehandles({preview:true,stackOrder:4,handleSize:10,handleHitThreshold:6,handleIcon:false,handleColor:"#ff0000",handleLineType:"ghost",handleLineWidth:3,handleOutlineColor:"#000000",handleOutlineWidth:0,handleNodes:"node",handlePosition:"middle top",hoverDelay:100,cxt:false,enabled:true,toggleOffOnLeave:false,edgeType:function b(j,k){return"flat"},loopAllowed:function h(j){return true},nodeLoopOffset:-50,nodeParams:function e(j,k){return{}},edgeParams:function d(m,n,l){var k=m.data("id")+"-"+n.data("id")+"-";var j=0;while(cy.$id(k+j).length!==0){j+=1}return{data:{id:k+j,source:m.data("id"),target:n.data("id"),weight:parseInt(weight_input.value)}}},start:function i(j){},complete:function a(l,k,j){if(auto_refresh.checked){cyReLayout()}j.forEach(function(m){if(m.isEdge()){m.animate({style:{lineColor:"red",width:5},duration:100}).animate({style:{lineColor:"#ccc",width:2},duration:500})}})},stop:function c(j){},cancel:function g(k,l,j){}});document.addEventListener("keydown",function(j){j=j||event;var k=j.which||j.keyCode||j.charCode;if(j.altKey){if(k==67){addEdgeBetweenSelected()}else{if(k==65){addNode(true,null)}else{if(k==70){reLayout()}else{if(k==83){clearSource()}else{if(k==82){clearResult()}}}}}}else{if(j.ctrlKey){if(k==67){copy(cy.$(":selected"))}else{if(k==86){paste()}else{if(k==83){stopAnimation()}else{if(k==65){cy.elements().select()}else{if(k==82){clearCaStyle()}else{if(k==70){clearCyStyle()}}}}}}}else{if(k==46){removeSelected()}}}});reLayout()});function clearCyStyle(){cy.elements().removeStyle();cy.style().resetToDefault().selector("node").style(defaultNodeStyle).selector("edge").style(defaultEdgeStyle).update();cy.$(":selected").select()}function clearCaStyle(){ca.elements().removeStyle();ca.style().resetToDefault().selector("node").style(defaultNodeStyle).selector("edge").style(defaultEdgeStyle).update();ca.$(":selected").select()}function copy(a){copiedEles=a}function paste(){if(copiedEles===undefined){return}var a={};cy.elements().unselect();copiedEles.forEach(function(c){if(c.isNode()){var b=addOneNode(false,{x:c.position("x")+25,y:c.position("y")+25});b.select();a[c.data("id")]=b.data("id")}});copiedEles.forEach(function(b){if(b.isEdge()){if(a[b.data("source")]!==undefined&&a[b.data("target")]!==undefined){addEdgeBwt(a[b.data("source")],a[b.data("target")],b.data("weight")).select()}}})}function initializeCytoscapeObjects(a){var b=cytoscape({container:document.getElementById(a)});b.on("select",function(c){c.target.style({"background-color":"green","line-color":"green"})});b.on("unselect",function(c){c.target.style({"background-color":"#666","line-color":"#ccc"})});b.panzoom({zoomDelay:20,zoomFactor:0.02,panSpeed:5,panDistance:1,fitPadding:20,animateOnFit:true,fitAnimationDuration:500});b.snapToGrid();b.snapToGrid("snapOff");b.snapToGrid("gridOff");return b}function selectAllOfTheSameType(a){cy.elements().unselect();if(a.isNode()){cy.nodes().select()}else{if(a.isEdge()){cy.edges().select()}}}function initConventionalMenu(b){b.contextMenus({menuItems:[{id:"remove",content:"remove",tooltipText:"remove this element only",selector:"node, edge",onClickFunction:function a(c){var d=c.target||c.cyTarget;d.remove()}},{id:"duplicate-edge",content:"duplicate edge",tooltipText:"duplicate this edge",selector:"edge",onClickFunction:function a(c){duplicateEdge(c.target,cy)}},{id:"change-weight",content:"change weight",tooltipText:"set a new weight for this edge",selector:"edge",onClickFunction:function a(c){var d=parseInt(prompt("Please enter a weight for this edge.","1"));if(!isNaN(d)){c.target.data("weight",d)}else{c.target.data("weight","")}}},{id:"add-node",content:"add node",tooltipText:"add node",coreAsWell:true,onClickFunction:function a(c){var d=c.position||c.cyPosition;addNode(false,{x:d.x,y:d.y})}},{id:"add-edge",content:"add edge",tooltipText:"add edge(s) between selected nodes",selector:"node",onClickFunction:function a(c){addEdgeBetweenSelected()}},{id:"remove-selected",content:"remove selected",tooltipText:"remove selected elements",selector:"node, edge",coreAsWell:true,onClickFunction:function a(c){removeSelected()},hasTrailingDivider:true},{id:"select-all-nodes",content:"select all nodes",tooltipText:"select all nodes",selector:"node",onClickFunction:function a(c){selectAllOfTheSameType(c.target||c.cyTarget)},hasTrailingDivider:true},{id:"select-all-edges",content:"select all edges",tooltipText:"select all edges",selector:"edge",onClickFunction:function a(c){selectAllOfTheSameType(c.target||c.cyTarget)},hasTrailingDivider:true},{id:"bfs",content:"start BFS",tooltipText:"start breadth first search at this node",selector:"node",onClickFunction:function a(c){cy.elements().unselect();var d=c.target||c.cyTarget;d.select();breadthFirstSearch()}},{id:"dfs",content:"start DFS",tooltipText:"start depth first search at this node",selector:"node",onClickFunction:function a(c){cy.elements().unselect();var d=c.target||c.cyTarget;d.select();depthFirstSearch()}}]})}function initCircularMenu(b){b.cxtmenu({menuRadius:75,activePadding:10,selector:"node",commands:[{content:'<i class="fa fa-road fa-2x" aria-hidden="true"></i>',select:function a(c){c.select();addEdgeBetweenSelected()}},{content:'<i class="fa fa-trash fa-2x" aria-hidden="true"></i>',select:function a(c){cy.remove(c);if(auto_refresh.checked){cyReLayout()}}},{content:"BFS",select:function a(c){cy.elements().unselect();c.select();breadthFirstSearch()}},{content:"DFS",select:function a(c){cy.elements().unselect();c.select();depthFirstSearch()}}]});b.cxtmenu({menuRadius:75,activePadding:10,selector:"edge",commands:[{content:'<i class="fa fa-trash fa-2x" aria-hidden="true"></i>',select:function a(c){cy.remove(c);if(auto_refresh.checked){cyReLayout()}}},{content:'<i class="fa fa-plus fa-2x" aria-hidden="true"></i>',select:function a(c){duplicateEdge(c,cy)}},{content:'<i class="fa fa-tag fa-2x" aria-hidden="true"></i>',select:function a(d){var c=parseInt(prompt("Please enter a weight for this edge.","1"));if(!isNaN(c)){d.data("weight",c)}else{d.data("weight","")}}}]});b.cxtmenu({menuRadius:75,activePadding:10,selector:"core",commands:[{content:'<i class="fa fa-plus fa-2x" aria-hidden="true"></i>',select:function a(){addNode(false,null)}},{content:'<i class="fa fa-trash fa-2x" aria-hidden="true"></i>',select:function a(){cy.remove(cy.elements(":selected"))}},{content:'<i class="fa fa-crosshairs fa-2x" aria-hidden="true"></i>',select:function a(){cy.elements().select()}},{content:'<i class="fa fa-refresh fa-2x" aria-hidden="true"></i>',select:function a(){reLayout()}},{content:'<i class="fa fa-external-link fa-2x" aria-hidden="true"></i>',select:function a(){if(drawOn){b.edgehandles("drawoff")}else{b.edgehandles("drawon")}drawOn=!drawOn}}]})}function addNode(e,a){stopAnimation();var d=document.getElementById("nid");var b=parseInt(d.value);b=isNaN(b)?1:b<1?1:b;for(var c=0;c<b;c++){addOneNode(e,a)}if(auto_refresh.checked){cyReLayout()}}function addOneNode(c,a){var b=1;while(cy.$id(b+"").length!==0){b+=1}if(c){return cy.add({group:"nodes",data:{id:b},position:{x:parseInt(Math.random()*500+25),y:parseInt(Math.random()*500+25)}})}else{if(a===null){return cy.add({group:"nodes",data:{id:b}})}else{return cy.add({group:"nodes",data:{id:b},position:a})}}}function addEdge(){stopAnimation();var b=document.getElementById("src_tg");var k=b.value;var h=k.split("-");var g=h[0];var e=h[1];var d=h[2]===undefined?1:isNaN(parseInt(h[2]))?1:parseInt(h[2]);if(d<1){d=1}var j=0;var a=g+"-"+e+"-";for(var c=0;c<d;c++){while(cy.$id(a+j).length!==0){j+=1}cy.add({group:"edges",data:{id:a+j,source:g,target:e,weight:parseInt(weight_input.value)}})}if(auto_refresh.checked){cyReLayout()}}function snapToGrid(b,a){if(a){b.snapToGrid("snapOn");b.snapToGrid("gridOn")}else{b.snapToGrid("snapOff");b.snapToGrid("gridOff")}}function changeLayout(a){var b=document.getElementById("layout").options[a].value;if(b==="snapToGrid"){snapToGrid(cy,true);snapToGrid(ca,true);layoutname=""}else{snapToGrid(cy,false);snapToGrid(ca,false);layoutname=b}reLayout()}function reLayout(){cyReLayout();caReLayout()}function cyReLayout(){var a=0;for(var b=0;b<cy.edges().length;b++){a+=getWeight(cy.edges()[b])}document.getElementById("cy_weight").innerHTML=a.toString();if(CyLayout!==undefined){CyLayout.stop()}if(layoutname===""){return}CyLayout=cy.layout(layout_options[layoutname]);CyLayout.run()}function caReLayout(){var a=0;for(var b=0;b<ca.edges().length;b++){a+=getWeight(ca.edges()[b])}document.getElementById("ca_weight").innerHTML=a.toString();if(CaLayout!==undefined){CaLayout.stop()}if(layoutname===""){return}CaLayout=ca.layout(layout_options[layoutname]);CaLayout.run()}function removeNode(){stopAnimation();var e=document.getElementById("nodeid");var b=e.value;var i=b.split(",");if(i.length===1){var a=b.split("-");if(a.length===1){cy.remove(cy.nodes().$id(b))}else{var d=parseInt(a[0]);var h=parseInt(a[1]);for(var g=d;g<=h;g++){cy.remove(cy.$id(g))}}}else{for(var c=0;c<i.length;c++){cy.remove(cy.$id(parseInt(i[c])))}}e.value="";if(auto_refresh.checked){cyReLayout()}}function removeEdge(){stopAnimation();var e=document.getElementById("r_src_tg");var c=e.value;var h=c.split("-");if(h[1]===undefined){return}var b=h[2]===undefined?1:parseInt(h[2]);var a=cy.edges("[id ^='"+h[0]+"-"+h[1]+"-']").union(cy.edges("[id ^='"+h[1]+"-"+h[0]+"-']"));var g=b>a.length?a.length:b;for(var d=0;d<g;d++){cy.remove(a[d])}if(auto_refresh.checked){cyReLayout()}}function duplicateEdge(d,e){var a=d.data("id").split("-");var b=0;while(e.$id(a[0]+"-"+a[1]+"-"+b).length!==0){b+=1}return e.add({group:"edges",data:{id:a[0]+"-"+a[1]+"-"+b,source:a[0],target:a[1],weight:d.data("weight")}})}function removeSelected(){stopAnimation();cy.remove(cy.$(":selected"));if(auto_refresh.checked){cyReLayout()}}function addEdgeBetweenSelected(){stopAnimation();var b=cy.nodes(":selected");var e=parseInt(weight_input.value);var a=b.length;if(a>1){for(var d=0;d<b.length;d++){for(var c=d+1;c<b.length;c++){addEdgeBwt(b[d].data("id"),b[c].data("id"),e)}}}else{if(a===1){addEdgeBwt(b[0].data("id"),b[0].data("id"),e)}}if(auto_refresh.checked){cyReLayout()}}function addEdgeBwt(e,d,c){var b=e+"-"+d+"-";var a=0;while(cy.$id(b+a).length!==0){a+=1}return cy.add({group:"edges",data:{id:b+a,source:e,target:d,weight:c}})}function getWeight(a){var b=a.data("weight");return isNaN(b)?1:b}function getTarget(b,a){var c=void 0;if(a.data("source")===b.data("id")){c=cy.$id(a.data("target"))}else{c=cy.$id(a.data("source"))}return c}function getCaTarget(b,a){var c=void 0;if(a.data("source")===b.data("id")){c=ca.$id(a.data("target"))}else{c=ca.$id(a.data("source"))}return c}function clearSource(){stopAnimation();cy.remove(cy.elements());document.getElementById("cy_weight").innerHTML=""}function clearResult(){stopAnimation();ca.remove(ca.elements());document.getElementById("ca_weight").innerHTML="";document.getElementById("path").innerHTML=""}function stopAnimation(){cy.elements().stop();ca.elements().stop();animationFlag=false}function readAM(){clearCyStyle();createFromAM(eval(matrix_input.value))}function readWM(){clearCyStyle();createFromWM(eval(matrix_input.value))}function createFromAM(c){stopAnimation();if(c.length!==c[0].length){return}clearSource();var b=c.length;cy.startBatch();if(layoutname===""){for(var e=1;e<=b;e++){cy.add({group:"nodes",data:{id:e},position:{x:Math.random()*250+25,y:Math.random()*250+25}})}}else{for(var g=1;g<=b;g++){cy.add({group:"nodes",data:{id:g}})}}for(var h=0;h<b;h++){for(var d=h;d<b;d++){for(var a=0;a<c[h][d];a++){cy.add({group:"edges",data:{id:h+1+"-"+(d+1)+"-"+a,source:h+1,target:d+1}})}}}cy.endBatch();cyReLayout()}function createFromWM(b){stopAnimation();if(b.length!==b[0].length){return}clearSource();var a=b.length;cy.startBatch();if(layoutname===""){for(var d=1;d<=a;d++){cy.add({group:"nodes",data:{id:d},position:{x:Math.random()*250+25,y:Math.random()*250+25}})}}else{for(var g=1;g<=a;g++){cy.add({group:"nodes",data:{id:g}})}}for(var e=0;e<a;e++){for(var c=e;c<a;c++){if(b[e][c]>0){cy.add({group:"edges",data:{id:e+1+"-"+(c+1)+"-0",source:e+1,target:c+1,weight:b[e][c]}})}}}cy.endBatch();cyReLayout()}function generateGraph(){stopAnimation();clearCyStyle();var m=document.getElementById("simple").checked;var p=document.getElementById("weighted").checked;var a=parseInt(prompt("Please enter the number of nodes","6"));var n=new Array(a);for(var q=0;q<n.length;q++){n[q]=new Array(a)}if(m){var s=parseFloat(prompt("Please specify the propability that two nodes are connected.\nRange: 0 to 1","0.5"));if(p){var h=prompt("Please specify the weight range.\nExample: 1-5 represents range from 1 to 5.\n Lower limit must be greater than 0.","1-4");var t=h.split("-");var u=parseInt(t[0])>0?parseInt(t[0]):1;var k=parseInt(t[1])>=u?parseInt(t[1])-u+1:u+4;for(var e=0;e<a;e++){for(var o=e+1;o<a;o++){if(Math.random()<s){n[e][o]=Math.floor(Math.random()*k+u)}else{n[e][o]=0}}}createFromWM(n)}else{for(var d=0;d<a;d++){for(var b=d+1;b<a;b++){if(Math.random()<s){n[d][b]=1}else{n[d][b]=0}}}createFromAM(n)}}else{var g=parseInt(prompt("Please specify the max number of edges connecting two nodes.\nRange: 2 to infinity","2"));var r=parseFloat(prompt("Please specify the the probability of having multiple edges","0.25"));for(var c=0;c<a;c++){for(var l=c;l<a;l++){if(c===l){if(Math.random()<r/2){n[c][l]=Math.floor((Math.random()*g+1)/2)}}else{if(Math.random()<r){n[c][l]=Math.floor(Math.random()*g+1)}else{if(Math.random()>1/g){n[c][l]=1}else{n[c][l]=0}}}}}createFromAM(n)}}function Kn(){stopAnimation();clearSource();var a=parseInt(prompt("Please enter the number of vertices","5"));var c=prompt("Please specify the weight range.\nLeave this blank if you want an unweighted graph.\nExample: 1-5 represents range from 1 to 5.\nLower limit must be greater than 0.","");var l=new Array(a);if(c.length>0){var m=c.split("-");var e=parseInt(m[0])>0?parseInt(m[0]):1;var g=parseInt(m[1])>e?parseInt(m[1])-e+1:e+4;for(var d=0;d<a;d++){l[d]=new Array(a);for(var b=d+1;b<a;b++){l[d][b]=parseInt(Math.random()*g+e)}}createFromWM(l)}else{for(var k=0;k<a;k++){l[k]=new Array(a);for(var h=k+1;h<a;h++){l[k][h]=1}}createFromAM(l)}}function Kn_n(){stopAnimation();var b=prompt("Please enter n,n.\nExample: 3,3 represents K3,3","3,3");b=b.split(",");var m=parseInt(b[0]);var l=parseInt(b[1]);var a=m+l;var p=new Array(a);for(var g=0;g<a;g++){p[g]=new Array(a)}var e=prompt("Please specify the weight range.\nLeave this blank if you want an unweighted graph.\nExample: 1-5 represents range from 1 to 5.\nLower limit must be greater than 0.","");if(e.length>0){var r=e.split("-");var d=parseInt(r[0])>0?parseInt(r[0]):1;var h=parseInt(r[1])>d?parseInt(r[1]):d+4;for(var o=0;o<m;o++){for(var c=m;c<a;c++){p[o][c]=parseInt(Math.random()*h+d)}}createFromWM(p)}else{for(var q=0;q<m;q++){for(var k=m;k<a;k++){p[q][k]=1}}createFromAM(p)}}function getCyStartNode(c,a){var b=cy.nodes(":selected");if(b.length<=0){b=cy.$id(prompt(c,a));if(b.length<=0){return undefined}}else{b=b[0]}return b}function breadthFirstSearch(){stopAnimation();var a=getCyStartNode("Please enter the id of the starting node","1");if(a===undefined){return}clearCyStyle();cy.elements().unselect();var b=cy.elements().bfs(a).path;clearResult();var c=new LinkedList();b.select();ca.add(b);b.forEach(function(d){c.add(d)});caReLayout();c.traverse(animation.checked,true)}function depthFirstSearch(){stopAnimation();var a=getCyStartNode("Please enter the id of the starting node","1");if(a===undefined){return}clearCyStyle();cy.elements().unselect();var b=cy.elements().dfs(a).path;clearResult();var c=new LinkedList();b.select();ca.add(b);b.forEach(function(d){c.add(d)});caReLayout();c.traverse(animation.checked,true)}function performKruskal(){stopAnimation();clearCyStyle();cy.elements().unselect();var a=cy.elements().kruskal(getWeight);clearResult();ca.add(a);a.select();caReLayout();var b=new LinkedList();a.forEach(function(c){if(c.isEdge()){b.add(c);if(b.search(function(d){return d.data("id")===c.source().data("id")})===null){b.add(c.source())}if(b.search(function(d){return d.data("id")===c.target().data("id")})===null){b.add(c.target())}}});b.traverse(animation.checked,false)}function performDijkstra(){stopAnimation();var a=cy.nodes(":selected");var d=void 0;if(a.length>=2){d=cy.elements().dijkstra(a[0],getWeight).pathTo(a[1])}else{var c=prompt("Please enter the id of source and target nodes, src-tg.\nExample: 1-2","");var b=c.split("-");d=cy.elements().dijkstra("#"+b[0],getWeight).pathTo("#"+b[1])}var e=new LinkedList();d.forEach(function(g){e.add(g)});clearCyStyle();clearResult();ca.add(d);caReLayout();d.select();e.traverse(animation.checked,true)}function myDijkstra(){function j(p,q){if(p!==undefined&&p.length>0){p.animate({style:{backgroundColor:"#f185dc",width:"30px",height:"30px"},duration:Math.round(+duration.value*0.1),queue:true}).animate({style:{backgroundColor:"#de4400",width:"20px",height:"20px"},duration:Math.round(+duration.value*0.4),queue:true,complete:q})}else{q()}}function h(p,q){if(p!==undefined&&p.length>0){p.animate({style:{lineColor:"#f185dc",width:"6"},duration:Math.round(+duration.value*0.2),queue:true}).animate({style:{lineColor:"#de4400",width:"3"},duration:Math.round(+duration.value*0.8),queue:true,complete:q})}else{q()}}function d(p,q){if(p!==undefined&&p.length>0){p.animate({style:{textBackgroundColor:"yellow",textBackgroundOpacity:1},duration:Math.round(+duration.value*0.4),queue:true}).delay(+duration.value*0.2).animate({style:{textBackgroundColor:"yellow",textBackgroundOpacity:0},duration:Math.round(+duration.value*0.4),queue:true,complete:q})}else{q()}}function m(q){q.animate({style:{backgroundColor:"#eae90f",width:"30px",height:"30px"},duration:Math.round(+duration.value*0.15),queue:true}).animate({style:{backgroundColor:"green",width:"20px",height:"20px"},duration:Math.round(+duration.value*0.6),queue:true,complete:function p(){if(!animationFlag){return}q.select();var s=q.data("previous");if(s!==undefined){s=k.$id(s);var t=s.edgesWith(q);t.animate({style:{lineColor:"#eae90f",width:"6"},duration:Math.round(+duration.value*0.2),queue:true}).animate({style:{lineColor:"green",width:"3"},duration:Math.round(+duration.value*0.8),queue:true,complete:function r(){if(animationFlag){t.select();m(s)}}})}else{clearResult();ca.add(cy.$(":selected"));caReLayout();k.removeData("previous")}}})}function i(p,t,u){var v=p.data("permanent");if(u>=t.length){var s=Infinity;var x=void 0;k.forEach(function(z){var y=z.data("temporary");if(y.length>0&&z.data("permanent")===undefined){if(y[y.length-1]<s||y[y.length-1]===s&&z.data("id")===g.data("id")){s=y[y.length-1];x=z}}});j(x,function(){if(!animationFlag){return}x.data("permanent",s);x.style({textBorderOpacity:1,textBorderWidth:"1px",textBorderStyle:"dashed",textBorderColor:"green"});var y=x.edgesWith(cy.$id(x.data("previous")));h(y,function(){if(!animationFlag){return}if(g.data("permanent")===undefined){i(x,x.connectedEdges(),0)}else{m(x)}})})}else{var q=t[u];var r=getTarget(p,q);var w=getWeight(q)+v;if(r.data("permanent")===undefined){h(q,function(){if(!animationFlag){return}var y=r.data("temporary").concat();if(y.length===0||y[y.length-1]>w){j(r,function(){if(!animationFlag){return}y.push(w);r.data("temporary",y);r.data("previous",p.data("id"))});d(r,function(){if(!animationFlag){return}r.style({backgroundColor:"",width:"",height:""});q.removeStyle();i(p,t,u+1)})}else{q.removeStyle();i(p,t,u+1)}})}else{i(p,t,u+1)}}}if(!isConnected()){alert("This graph is not connected!");return}var l=void 0;var g=void 0;var k=cy.nodes();var o=cy.nodes(":selected");if(o.length>=2){l=o[0];g=o[1]}else{o=prompt("Please enter the id of source and target nodes, src-tg.\nExample: 1-2","");var b=o.split("-");l=cy.$id(b[0]);g=cy.$id(b[1]);if(l.length<=0||g.length<=0){return}}clearCyStyle();k.data("temporary",[]);k.removeData("permanent");k.removeData("previous");cy.style().selector("node").style({label:function n(t){var q=t.data("temporary");var p=q.length-1;var r="";if(p>-1){r+="|";for(var s=0;s<p;s++){r+=q[s]+">"}r+=q[p]}return t.data("id")+r+(isNaN(t.data("permanent"))?"":"|"+t.data("permanent"))}});var a=l;a.data("permanent",0);a.data("temporary",[0]);if(animation.checked){a.style({textBorderOpacity:1,textBorderWidth:"1px",textBorderStyle:"dashed",textBorderColor:"green"});j(a,function(){i(a,a.connectedEdges(),0)})}else{var c=function c(){var q=a.connectedEdges();var r=a.data("permanent");q.forEach(function(w){var v=getTarget(a,w);var u=getWeight(w)+r;if(v.data("permanent")===undefined){var t=v.data("temporary").concat();if(t.length===0||t[t.length-1]>u){t.push(u);v.data("temporary",t);v.data("previous",a.data("id"))}}});var p=Infinity;var s=void 0;k.forEach(function(u){var t=u.data("temporary");if(t.length>0&&u.data("permanent")===undefined){if(t[t.length-1]<p||t[t.length-1]===p&&u.data("id")===g.data("id")){p=t[t.length-1];s=u}}});s.data("permanent",p);s.style({textBorderOpacity:1,textBorderWidth:"1px",textBorderStyle:"dashed",textBorderColor:"green"});a=s};while(g.data("permanent")===undefined){c()}cy.startBatch();var e=a.data("previous");while(e!==undefined){a.select();a.edgesWith(cy.$id(e)).select();a=cy.$id(e);e=a.data("previous")}a.select();cy.endBatch();clearResult();ca.add(cy.$(":selected"));caReLayout();k.removeData("previous")}}function prim(){stopAnimation();clearCyStyle();var b=getCyStartNode("Please enter the id of the starting node","1");if(b===undefined){b=cy.nodes()[0]}cy.elements().unselect();b.select();var d=function d(){var h=cy.nodes(":selected");var m=Infinity;var n=void 0;for(var l=0;l<h.length;l++){var g=h[l].connectedEdges(":unselected");for(var k=0;k<g.length;k++){if(!getTarget(h[l],g[k]).selected()){var e=getWeight(g[k]);if(e<m){m=e;n=g[k]}}}}return n};var a=new LinkedList();a.add(b);while(cy.nodes(":unselected").length>0){var c=d();c.select();a.add(c);if(c.target().selected()){c.source().select();a.add(c.source())}else{c.target().select();a.add(c.target())}}clearResult();ca.add(cy.$(":selected"));caReLayout();a.traverse(animation.checked,true)}function localMinimalWeightCycle(a){var b=Infinity;var h=void 0,c=void 0,g=void 0,e=void 0,i=void 0,j=void 0;cy.startBatch();a.connectedEdges().forEach(function(d){g=getTarget(a,d);e=getWeight(d);cy.remove(d);i=cy.elements().dijkstra(a,getWeight);j=i.distanceTo(g)+e;if(j<b){b=j;h=i.pathTo(g);c=d}cy.add(d)});cy.endBatch();return[b,h,c]}function minimalWeightCycle(){stopAnimation();var c=getCyStartNode("Please enter id of the starting node.\nIf you want apply this algorithm too all nodes and get the best one, leave it blank","");var d=void 0;clearCyStyle();cy.elements().unselect();if(c===undefined){var b=Infinity;var a=void 0;var e=void 0;cy.nodes().forEach(function(g){d=localMinimalWeightCycle(g);if(d[0]<b){b=d[0];a=d[1];e=d[2]}});clearResult();a.select();e.select();ca.add(a);ca.add(e)}else{d=localMinimalWeightCycle(c);clearResult();d[1].select();d[2].select();ca.add(d[1]);ca.add(d[2])}caReLayout()}function nearestNeighbor(){stopAnimation();var b=getCyStartNode("Please enter id of the starting node.\nIf you want apply this algorithm too all nodes and get the best one, leave it blank","");clearCyStyle();cy.elements().unselect();var c=void 0;if(b===undefined){var d=Infinity;var e=void 0;var a=void 0;cy.startBatch();cy.nodes().forEach(function(h){c=nearestNeighborAlgorithm(h);var g=c[0];if(g<=d){e=cy.$(":selected");d=g;a=c[1]}cy.elements().unselect()});clearResult();ca.add(e);e.select();cy.endBatch();a.traverse(animation.checked,true)}else{c=nearestNeighborAlgorithm(b);clearResult();ca.add(cy.$(":selected"));c[1].traverse(animation.checked,true)}caReLayout()}function nearestNeighborAlgorithm(c){var d=c;cy.startBatch();var i=function i(l){var j=Infinity;var k=undefined;l.connectedEdges().forEach(function(n){if(!getTarget(l,n).selected()){var m=getWeight(n);if(m<j){j=m;k=n}}});return k};var g=i(d);var b=0;var a=1;var h=new LinkedList();h.add(d);d.select();while(g!==undefined){a+=1;b+=getWeight(g);d=getTarget(d,g);h.add(g);h.add(d);g.select();d.select();g=i(d)}var e=cy.edges("[id ^='"+c.data("id")+"-"+d.data("id")+"-']").union(cy.edges("[id ^='"+d.data("id")+"-"+c.data("id")+"-']"));if(e.length===0){b+=Math.pow(2,32)}else{e[0].select();h.add(e[0])}h.add(c);cy.endBatch();return[b+(cy.nodes().length-a)*Math.pow(2,32),h]}function isConnected(){var a=cy.elements().bfs(cy.nodes()[0]).path;return a.nodes().length===cy.nodes().length}var LinkedListNode=function LinkedListNode(b,a){_classCallCheck(this,LinkedListNode);this.cargo=b;this.next=a};var LinkedList=function(){function e(){_classCallCheck(this,e);this.head=null;this.length=0}_createClass(e,[{key:"getTail",value:function c(){var h=this.head;while(h.next!==null){h=h.next}return h}},{key:"add",value:function d(h){if(this.length===0){this.head=new LinkedListNode(h,null)}else{this.getTail().next=new LinkedListNode(h,null)}this.length+=1}},{key:"addNode",value:function g(h){if(this.length===0){this.head=h}else{this.getTail().next=h}this.length+=1}},{key:"search",value:function a(i){var h=this.head;while(h!==null){if(i(h.cargo)){return h}h=h.next}return null}},{key:"traverse",value:function b(j,n){var l=this.head;var i=0;if(n){var h="";while(l!==null){var k=l.cargo;if(k.isNode()){h+='<span class="normal" id="n'+i+'">'+k.data("id")+"</span>"}else{h+='<span class="normal" id="n'+i+'"> → </span>'}i+=1;l=l.next}document.getElementById("path").innerHTML=h}if(j){animationFlag=true;l=this.head;i=1;var m=function m(p){if(p.cargo.isNode()){p.cargo.animate({style:{backgroundColor:"#00f1f1",width:"30px",height:"30px"},duration:Math.round(+duration.value*0.1)}).animate({style:{backgroundColor:"#de4400",width:"20px",height:"20px"},duration:Math.round(+duration.value*0.4),complete:function o(){if(!animationFlag){return}if(p.next!==null){if(n){document.getElementById("n"+i).className="current";document.getElementById("n"+(i-1)).className="normal";i+=1}m(p.next)}}})}else{p.cargo.animate({style:{lineColor:"#00f1f1",width:"6"},duration:Math.round(+duration.value*0.2)}).animate({style:{lineColor:"#de4400",width:"3"},duration:Math.round(+duration.value*0.8),complete:function o(){if(!animationFlag){return}if(p.next!==null){if(n){document.getElementById("n"+i).className="current";document.getElementById("n"+(i-1)).className="normal";i+=1}m(p.next)}}})}};if(n){document.getElementById("n0").className="current"}m(l)}}}]);return e}();function eulerianCycle(){stopAnimation();if(!isConnected()){return alert("This graph is not connected")}var a=0;cy.nodes().forEach(function(b){if(b.degree()%2!==0){a+=1}});if(a!==0&&a!==2){return alert("This graph is neither Eulerian nor semi-Eulerian")}cy.elements().unselect();clearResult();ca.add(cy.elements());caReLayout();traceEulerianCycle(ca.nodes()[0],ca)}function traceEulerianCycle(j,i){var d=j;var h=new LinkedList();h.add(d);var a=d.connectedEdges(":unselected");var b=undefined;while(true){while(a.length>0){var g=a[0];g.select();h.add(g);d.select();d=getCaTarget(d,g);a=d.connectedEdges(":unselected");h.add(d)}d.select();if(b!==undefined){h.addNode(b)}if(i.edges(":unselected").length!==0){var e=h.search(function(c){if(c.isNode()){if(c.connectedEdges(":unselected").length>0){return true}}});b=e.next;d=e.cargo;e.next=null;a=d.connectedEdges(":unselected")}else{break}}i.elements().unselect();h.traverse(animation.checked,true)}function f(a){return a<=1?1:a*f(a-1)}function minimalWeightMatching(){stopAnimation();clearCyStyle();cy.elements().unselect();if(!isConnected()){return alert("Graph not connected!")}var a=cy.nodes().length;if(a>14){if(!confirm("Warning! This graph has "+a+" nodes, at most "+f(a)/(f(a/2)*Math.pow(2,a/2))+" iterations are needed and it might take a long time！")){return}}clearResult();function c(h){function g(n,i){var o=cy.$id(n.data("id")+"-"+i.data("id")+"-0");return o.length===0?cy.$id(i.data("id")+"-"+n.data("id")+"-0"):o}var d=cy.nodes();for(var k=0;k<h.length;k+=2){var l=d[h[k]];if(h[k+1]===undefined){break}var j=d[h[k+1]];var m=g(l,j);ca.add(l);ca.add(j);ca.add(m);l.select();j.select();m.select()}caReLayout()}var b=getWM(cy,false);minimalWeightMatchingMultiThread(b,4,c)}function minimalWeightMatchingMultiThread(h,o,k){var e=regeneratorRuntime.mark(a);function a(){var q,t,u,s,r;return regeneratorRuntime.wrap(function p(i){while(1){switch(i.prev=i.next){case 0:if(!true){i.next=9;break}i.next=3;return null;case 3:q=c[0];for(t=1;t<o;t++){q=q&&c[t]}if(!(q===true)){i.next=7;break}return i.abrupt("break",9);case 7:i.next=0;break;case 9:u=Infinity;s=[];for(r=0;r<o;r++){if(l[r]<u){u=l[r];s=g[r]}}perform_button.disabled=false;k(s);case 14:case"end":return i.stop()}}},e,this)}var b=a();var c=new Array(o);var l=new Array(o);var g=new Array(o);var n=Math.floor(h.length/o);var m=_.range(0,h.length);perform_button.disabled=true;var j=function j(q){c[q]=false;l[q]=Infinity;var p=q;var r=new Worker("js/MWMMT.min.js");r.onmessage=function(i){console.log(p+" is ready");l[p]=i.data.minWeight;g[p]=i.data.minPairing;c[p]=true;b.next();r.terminate()};if(q===o-1){r.postMessage({weightMatrix:h,eles:m,start:p*n,end:h.length})}else{r.postMessage({weightMatrix:h,eles:m,start:p*n,end:(p+1)*n})}r.onerror=function(i){console.log(i.message)}};for(var d=0;d<o;d++){j(d)}}function CPP(){stopAnimation();clearCyStyle();cy.elements().unselect();cy.nodes().forEach(function(i){if(i.degree()%2!==0){i.select()}});var a=cy.nodes(":selected");var h=a.length;if(h>14){if(!confirm("Warning! This graph has "+h+" nodes of odd degree, at most "+f(h)/(f(h/2)*Math.pow(2,h/2))+" iterations are needed and it might take a long time！")){return}}var d=new Array(h);var e=new Array(h);for(var b=0;b<h;b++){e[b]=cy.elements().dijkstra(a[b],getWeight);d[b]=new Array(h);for(var g=b+1;g<h;g++){d[b][g]=e[b].distanceTo(a[g])}}minimalWeightMatchingMultiThread(d,4,c);function c(i){clearResult();ca.add(cy.elements());var j=undefined;for(var k=0;k<i.length;k+=2){e[i[k]].pathTo(a[i[k+1]]).forEach(function(l){if(l.isEdge()){l.select();var m=duplicateEdge(l,ca);if(j===undefined){j=m}else{j=j.union(m)}}})}caReLayout();ca.elements().unselect();traceEulerianCycle(ca.nodes()[0],ca)}}function TSPGlobalLowerBound(){stopAnimation();var a=getCyStartNode("Please enter id of the starting node.\nIf you want apply this algorithm too all nodes and get the highest lower bound, leave it blank","");var e=void 0;clearCyStyle();cy.elements().unselect();if(a===undefined){var c=0;var b=void 0,g=void 0,d=void 0;cy.nodes().forEach(function(h){e=TSPLowerBound(h);d=e[0];if(d>c){c=d;b=e;g=h}});clearResult();b[3].nodes().style({backgroundColor:"#eba300"});b[3].edges().style({lineColor:"#eba300"});b[2].select();b[1].select();ca.add(b[3]);ca.elements().select();ca.add(g);ca.add(b[2]);ca.add(b[1]);caReLayout()}else{e=TSPLowerBound(a);clearResult();e[3].nodes().style({backgroundColor:"#eba300"});e[3].edges().style({lineColor:"#eba300"});e[2].select();e[1].select();ca.add(e[3]);ca.elements().select();ca.add(a);ca.add(e[2]);ca.add(e[1]);caReLayout()}}function TSPLowerBound(a){cy.startBatch();var b=a.connectedEdges().sort(function(g,e){return getWeight(g)-getWeight(e)});var d=getWeight(b[0])+getWeight(b[1]);cy.remove(a);var c=cy.elements().kruskal(getWeight);c.edges().forEach(function(e){d+=getWeight(e)});cy.add(a);cy.add(b);cy.endBatch();return[d,b[0],b[1],c]}function getAM(l,e){var h=void 0,g=void 0;var d=l.nodes();var a=d.length;var b=new Array(a);var k={};for(h=0;h<a;h++){b[h]=new Array(a);k[d[h].data("id")]=h;for(g=0;g<a;g++){b[h][g]=0}}l.edges().forEach(function(c){h=k[c.data("source")];g=k[c.data("target")];b[h][g]+=1;if(h!==g){b[g][h]+=1}});if(e){matrix_input.value=matrixToString(b)}return b}function getWM(h,d){var g=void 0,e=void 0,l=void 0;var a=h.nodes();var b=a.length;var k=new Array(b);var m={};for(g=0;g<b;g++){k[g]=new Array(b);m[a[g].data("id")]=g;for(e=0;e<b;e++){k[g][e]=0}}h.edges().forEach(function(c){g=m[c.data("source")];e=m[c.data("target")];l=getWeight(c);if(k[g][e]===0){k[g][e]=l}else{if(l<k[g][e]){k[g][e]=l}}k[e][g]=k[g][e]});if(d){matrix_input.value=matrixToString(k)}return k}function matrixToString(a){var c="[["+a[0].toString()+"],\n";for(var b=1;b<a.length-1;b++){c+=" ["+a[b].toString()+"],\n"}c+=" ["+a[a.length-1].toString()+"]]";return c}function getGraphML(a){matrix_input.value=a.graphml()}function readGraphML(){clearSource();cy.graphml(matrix_input.value);cyReLayout()};